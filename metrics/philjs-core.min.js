let activeComputation=null,batchDepth=0,batchedUpdates=new Set,currentOwner=null;function signal(e){let t=e;const n=new Set,r=()=>(activeComputation&&(n.add(activeComputation),activeComputation.dependencies.add(n)),t);return r.set=e=>{const r="function"==typeof e?e(t):e;if(!Object.is(t,r))if(t=r,batchDepth>0){Array.from(n).forEach(e=>{batchedUpdates.add(e.execute)})}else{Array.from(n).forEach(e=>e.execute())}},r.subscribe=e=>{const r={execute:()=>e(t),dependencies:new Set};return n.add(r),()=>n.delete(r)},r.peek=()=>t,r}function memo(e){let t,n=!0;const r=new Set,s={execute:()=>{n=!0;Array.from(r).forEach(e=>e.execute())},dependencies:new Set},a=()=>{if(n){Array.from(s.dependencies).forEach(e=>e.delete(s)),s.dependencies.clear();const r=activeComputation;activeComputation=s;try{t=e(),n=!1}finally{activeComputation=r}}return activeComputation&&activeComputation!==s&&(r.add(activeComputation),activeComputation.dependencies.add(r)),t};return a.subscribe=e=>{const t={execute:()=>e(a()),dependencies:new Set};return r.add(t),()=>r.delete(t)},a(),a}function linkedSignal(e,t={}){const{resetOnChange:n=!0}=t;let r,s=!1,a=!0;const o=new Set,i={execute:()=>{!n&&s||(a=!0,s=!1);Array.from(o).forEach(e=>e.execute())},dependencies:new Set},c=()=>{if(a&&!s){Array.from(i.dependencies).forEach(e=>e.delete(i)),i.dependencies.clear();const t=activeComputation;activeComputation=i;try{r=e(),a=!1}finally{activeComputation=t}}return activeComputation&&activeComputation!==i&&(o.add(activeComputation),activeComputation.dependencies.add(o)),r};return c.set=e=>{const t="function"==typeof e?e(r):e;if(!Object.is(r,t))if(r=t,s=!0,a=!1,batchDepth>0){Array.from(o).forEach(e=>{batchedUpdates.add(e.execute)})}else{Array.from(o).forEach(e=>e.execute())}},c.reset=()=>{if(s=!1,a=!0,c(),batchDepth>0){Array.from(o).forEach(e=>{batchedUpdates.add(e.execute)})}else{Array.from(o).forEach(e=>e.execute())}},c.isOverridden=()=>s,c(),c}function effect(e){let t,n=!1,r=null;const s={execute:()=>{if(n)return;"function"==typeof t&&t(),r&&(r.cleanups.forEach(e=>e()),r.cleanups=[]);Array.from(s.dependencies).forEach(e=>e.delete(s)),s.dependencies.clear();const a=currentOwner;r={cleanups:[],owned:[]},currentOwner=r,a&&a.owned.push(r);const o=activeComputation;activeComputation=s;try{t=e()}finally{activeComputation=o,currentOwner=a}},dependencies:new Set};return s.execute(),()=>{if(n)return;n=!0,"function"==typeof t&&t(),r&&(r.cleanups.forEach(e=>e()),r.cleanups=[]);Array.from(s.dependencies).forEach(e=>e.delete(s)),s.dependencies.clear()}}function batch(e){batchDepth++;try{return e()}finally{if(batchDepth--,0===batchDepth){const e=Array.from(batchedUpdates);batchedUpdates.clear(),e.forEach(e=>e())}}}function untrack(e){const t=activeComputation;activeComputation=null;try{return e()}finally{activeComputation=t}}function onCleanup(e){currentOwner&&currentOwner.cleanups.push(e)}function createRoot(e){const t=currentOwner,n={cleanups:[],owned:[]};currentOwner=n;const r=()=>{n.owned.forEach(e=>disposeOwner(e)),n.owned=[],n.cleanups.forEach(e=>e()),n.cleanups=[]};try{return e(r)}finally{currentOwner=t}}function disposeOwner(e){e.owned.forEach(e=>disposeOwner(e)),e.cleanups.forEach(e=>e())}function resource(e){const t=signal(void 0),n=signal(!0),r=signal(null),s=()=>{n.set(!0),r.set(null);try{const s=e();s instanceof Promise?s.then(e=>{t.set(e),n.set(!1)}).catch(e=>{r.set(e instanceof Error?e:new Error(String(e))),n.set(!1)}):(t.set(s),n.set(!1))}catch(e){r.set(e instanceof Error?e:new Error(String(e))),n.set(!1)}};s();const a=()=>{if(r())throw r();return t()};return a.refresh=s,a.loading=()=>n(),a.error=()=>r(),a}function jsx(e,t,n){const{children:r,...s}=t||{};return{type:e,props:{...s,children:void 0!==r?normalizeChildren(r):void 0},key:n}}const jsxs=jsx,jsxDEV=jsx;function Fragment(e){return{type:Fragment,props:{children:normalizeChildren(e.children)}}}function normalizeChildren(e){return Array.isArray(e)?e.flat(1/0).filter(e=>null!=e&&!1!==e):null==e||!1===e?[]:[e]}function isJSXElement(e){return e&&"object"==typeof e&&"type"in e&&"props"in e}function createElement(e,t,...n){return jsx(e,{...t,children:n},t?.key)}const VOID_ELEMENTS=new Set(["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"]),BOOLEAN_ATTRS=new Set(["checked","selected","disabled","readonly","multiple","ismap","defer","declare","noresize","nowrap","compact","autoplay","controls","loop","muted"]);function renderToString(e){if(null==e||!1===e||!0===e)return"";if("string"==typeof e)return escapeHtml(e);if("number"==typeof e)return String(e);if(Array.isArray(e))return e.map(renderToString).join("");if(!isJSXElement(e))return"";const{type:t,props:n}=e;if(t===Fragment)return renderToString(n.children);if("function"==typeof t){return renderToString(t(n))}return"string"==typeof t?renderElement(t,n):""}function renderElement(e,t){const{children:n,...r}=t,s=renderAttrs(r),a=s?`<${e} ${s}>`:`<${e}>`;if(VOID_ELEMENTS.has(e))return a;return`${a}${renderToString(n)}</${e}>`}function renderAttrs(e){return Object.entries(e).filter(([e,t])=>null!=t&&!1!==t&&("function"!=typeof t&&!e.startsWith("__"))).map(([e,t])=>{const n="className"===e?"class":"htmlFor"===e?"for":e;if(BOOLEAN_ATTRS.has(n))return t?n:"";if("style"===n&&"object"==typeof t){return`style="${escapeAttr(Object.entries(t).map(([e,t])=>`${e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}:${t}`).join(";"))}"`}return`${n}="${escapeAttr(String(t))}"`}).filter(Boolean).join(" ")}function escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function escapeAttr(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;")}async function*renderToStream(e){yield renderToString(e)}function hydrate(e,t){hydrateNode(e,{currentNode:t.firstChild})}function hydrateNode(e,t){if(null==e||!1===e||!0===e)return;if("string"==typeof e||"number"==typeof e)return void(t.currentNode&&(t.currentNode=t.currentNode.nextSibling));if(Array.isArray(e))return void e.forEach(e=>hydrateNode(e,t));if(!isJSXElement(e))return;const{type:n,props:r}=e;if(n!==Fragment){if("function"==typeof n){return void hydrateNode(n(r),t)}if("string"==typeof n){const e=t.currentNode;if(!e||e.nodeName.toLowerCase()!==n.toLowerCase())return void console.warn(`Hydration mismatch: expected ${n}, got ${e?.nodeName}`);if(attachEventHandlers(e,r),r.children){const t={currentNode:e.firstChild};hydrateNode(r.children,t)}t.currentNode=e.nextSibling}}else hydrateNode(r.children,t)}function attachEventHandlers(e,t){for(const[n,r]of Object.entries(t))if("children"!==n)if(n.startsWith("on")&&"function"==typeof r){const t=n.slice(2).toLowerCase();e.addEventListener(t,r)}else if("style"===n){if("function"==typeof r){const t=()=>{const t=r();"object"==typeof t?Object.assign(e.style,t):"string"==typeof t&&e.setAttribute("style",t)};t(),"function"==typeof r.subscribe&&r.subscribe(t)}}else if("class"===n||"className"===n){if("function"==typeof r){const t=()=>{const t=r();e.className=t||""};t(),"function"==typeof r.subscribe&&r.subscribe(t)}}else if("function"==typeof r){const t=()=>{const t=r();null==t||!1===t?e.removeAttribute(n):!0===t?e.setAttribute(n,""):e.setAttribute(n,String(t))};t(),"function"==typeof r.subscribe&&r.subscribe(t)}}function render(e,t){t.innerHTML="";const n=createDOMElement(e);n&&(DocumentFragment,t.appendChild(n))}function createDOMElement(e){if(null==e||!1===e||!0===e)return null;if("string"==typeof e)return document.createTextNode(e);if("number"==typeof e)return document.createTextNode(String(e));if(Array.isArray(e)){const t=document.createDocumentFragment();return e.forEach(e=>{const n=createDOMElement(e);n&&t.appendChild(n)}),t}if(!isJSXElement(e))return null;const{type:t,props:n}=e;if(t===Fragment)return createDOMElement(n.children);if("function"==typeof t){return createDOMElement(t(n))}if("function"==typeof e)return createDynamicNode(e);if("string"==typeof t){const e=document.createElement(t);for(const[t,r]of Object.entries(n))if("children"!==t)if(t.startsWith("on")&&"function"==typeof r){const n=t.slice(2).toLowerCase();e.addEventListener(n,r)}else if("className"===t)if("function"==typeof r){const t=()=>{e.className=r()||""};t(),"function"==typeof r.subscribe&&r.subscribe(t)}else e.className=r;else if("class"===t)if("function"==typeof r){const t=()=>{e.className=r()||""};t(),"function"==typeof r.subscribe&&r.subscribe(t)}else e.className=r;else if("htmlFor"===t)e.htmlFor=r;else if("style"===t)if("function"==typeof r){const t=()=>{const t=r();"object"==typeof t?Object.assign(e.style,t):"string"==typeof t&&e.setAttribute("style",t)};t(),"function"==typeof r.subscribe&&r.subscribe(t)}else"object"==typeof r?Object.assign(e.style,r):"string"==typeof r&&e.setAttribute("style",r);else if("function"==typeof r){const n=()=>{const n=r();null==n||!1===n?e.removeAttribute(t):!0===n?e.setAttribute(t,""):e.setAttribute(t,String(n))};n(),"function"==typeof r.subscribe&&r.subscribe(n)}else"boolean"==typeof r?r&&e.setAttribute(t,""):null==r||t.startsWith("__")||e.setAttribute(t,String(r));if(n.children){(Array.isArray(n.children)?n.children:[n.children]).forEach(t=>{if("function"==typeof t){const n=createDynamicNode(t);return void e.appendChild(n)}const n=createDOMElement(t);n&&e.appendChild(n)})}return e}return null}function createDynamicNode(e){const t=document.createDocumentFragment(),n=document.createComment("philjs:dynamic-start"),r=document.createComment("philjs:dynamic-end");t.appendChild(n),t.appendChild(r);let s=[];const a=()=>{const t=n.parentNode;if(!t)return;s.forEach(e=>{e instanceof Comment&&e.__philjs_dispose&&e.__philjs_dispose(),e.parentNode&&e.parentNode.removeChild(e)}),s=[];const a=normalizeToNodes(e());a.forEach(e=>{t.insertBefore(e,r)}),s=a};if(a(),"function"==typeof e.subscribe){const t=e.subscribe(a);"function"==typeof t&&(r.__philjs_dispose=t)}else{const e=effect(()=>{a()});r.__philjs_dispose=e}return t}function normalizeToNodes(e){if(null==e||!1===e)return[];if(Array.isArray(e)){const t=[];return e.forEach(e=>{t.push(...normalizeToNodes(e))}),t}if(e instanceof DocumentFragment)return Array.from(e.childNodes);if(e instanceof Node)return[e];if("function"==typeof e)return normalizeToNodes(e());if(isJSXElement(e)){const t=createDOMElement(e);return t?t instanceof DocumentFragment?Array.from(t.childNodes):[t]:[]}return[document.createTextNode(String(e))]}let globalState=null;function initResumability(){return globalState={handlers:new Map,state:new Map,nextId:0},globalState}function getResumableState(){return globalState}function generateElementId(){if(!globalState)throw new Error("Resumability not initialized");return"q"+globalState.nextId++}function registerHandler(e,t,n){globalState&&(globalState.handlers.has(e)||globalState.handlers.set(e,new Map),globalState.handlers.get(e).set(t,n))}function registerState(e,t){globalState&&globalState.state.set(e,t)}function serializeResumableState(){if(!globalState)return"{}";const e={handlers:Object.fromEntries(Array.from(globalState.handlers.entries()).map(([e,t])=>[e,Object.fromEntries(t.entries())])),state:Object.fromEntries(globalState.state.entries())};return JSON.stringify(e)}function resume(){const e=document.getElementById("__PHIL_RESUMABLE__");if(!e)return void console.warn("No resumable state found");let t;try{t=JSON.parse(e.textContent||"{}")}catch(e){return void console.error("Failed to parse resumable state:",e)}const n=new Map;document.addEventListener("click",async e=>{let r=e.target,s=null;for(;r&&r!==document.body&&(s=r.getAttribute("data-qid"),!s||!t.handlers[s]?.click);)r=r.parentElement;if(!r||!s)return;const a=t.handlers[s].click;if(a)try{const o=(await async function(e){if(!n.has(e)){const t=import(e);n.set(e,t)}return n.get(e)}(a.module))[a.export];if("function"!=typeof o)return void console.error(`Handler ${a.export} is not a function`);const i=t.state[s],c={...a.closure,state:i,element:r};o.call(r,e,c)}catch(e){console.error("Failed to resume handler:",e)}}),["focus","blur","input","change","submit"].forEach(e=>{document.addEventListener(e,async e=>{})})}function resumable(e,t){return n=>{const r=e(n);return"undefined"==typeof window&&globalState?transformVNodeForResumability(r,t):r}}function transformVNodeForResumability(e,t){if(!e||"object"!=typeof e||!("type"in e))return e;const n={...e},{props:r}=n;if(Object.keys(r).some(e=>e.startsWith("on")&&"function"==typeof r[e])){const e=generateElementId();n.props={...r,"data-qid":e},Object.keys(r).forEach(s=>{if(s.startsWith("on")&&"function"==typeof r[s]){const r=s.slice(2).toLowerCase(),a=t.handlers?.[s]||s;registerHandler(e,r,{module:t.module,export:a}),delete n.props[s]}})}return r.children&&(n.props.children=Array.isArray(r.children)?r.children.map(e=>transformVNodeForResumability(e,t)):transformVNodeForResumability(r.children,t)),n}class QueryCache{cache=new Map;get(e){return this.cache.get(e)}set(e,t,n){this.cache.set(e,{data:t,error:n,timestamp:Date.now(),promise:void 0})}setPromise(e,t){const n=this.cache.get(e);n?n.promise=t:this.cache.set(e,{data:void 0,error:void 0,timestamp:Date.now(),promise:t})}delete(e){this.cache.delete(e)}clear(){this.cache.clear()}isStale(e,t){const n=this.cache.get(e);return!n||Date.now()-n.timestamp>t}}const queryCache=new QueryCache;function createQuery(e){const t=JSON.stringify(e.key),n=signal(e.initialData),r=signal(void 0),s=signal(!1),a=signal(!1),o=queryCache.get(t);o&&!queryCache.isStale(t,e.staleTime||0)&&(n.set(o.data),r.set(o.error));let i=!1;const c=async()=>{a.set(!0);try{const s=queryCache.get(t);if(s?.promise){const e=await s.promise;return n.set(e),e}const a=e.fetcher();queryCache.setPromise(t,a);const o=await a;return queryCache.set(t,o),n.set(o),r.set(void 0),e.onSuccess?.(o),o}catch(n){const s=n instanceof Error?n:new Error(String(n));throw queryCache.set(t,void 0,s),r.set(s),e.onError?.(s),s}finally{a.set(!1),s.set(!1),i||(i=!0,e.refetchOnFocus&&"undefined"!=typeof window&&window.addEventListener("focus",()=>{queryCache.isStale(t,e.staleTime||0)&&c()}),e.refetchOnReconnect&&"undefined"!=typeof window&&window.addEventListener("online",()=>{c()}),e.refetchInterval&&"undefined"!=typeof window&&setInterval(()=>{c()},e.refetchInterval))}};if(!o||queryCache.isStale(t,e.staleTime||0)){if(s.set(!0),e.suspense&&"undefined"==typeof window)throw c();c()}e.refetchOnFocus&&"undefined"!=typeof window&&window.addEventListener("focus",()=>{queryCache.isStale(t,e.staleTime||0)&&c()}),e.refetchOnReconnect&&"undefined"!=typeof window&&window.addEventListener("online",()=>{c()}),e.refetchInterval&&"undefined"!=typeof window&&setInterval(()=>{c()},e.refetchInterval);const u=memo(()=>void 0!==n()&&!r()),l=memo(()=>void 0!==r());return{data:n,error:r,isLoading:s,isFetching:a,isSuccess:u,isError:l,refetch:c,mutate:e=>{const r="function"==typeof e?e(n()):e;n.set(r),queryCache.set(t,{...queryCache.get(t),data:r})}}}function createMutation(e){const t=signal(void 0),n=signal(void 0),r=signal(!1),s=async s=>{r.set(!0),n.set(void 0);try{e.optimisticUpdate?.(s);const n=await e.mutationFn(s);return t.set(n),e.onSuccess?.(n,s),e.onSettled?.(n,void 0,s),n}catch(t){const r=t instanceof Error?t:new Error(String(t));throw n.set(r),e.onError?.(r,s),e.onSettled?.(void 0,r,s),r}finally{r.set(!1)}},a=memo(()=>void 0!==t()&&!n()),o=memo(()=>void 0!==n());return{mutate:e=>(s(e).catch(()=>{}),Promise.resolve(t())),mutateAsync:s,data:t,error:n,isPending:r,isSuccess:a,isError:o,reset:()=>{t.set(void 0),n.set(void 0),r.set(!1)}}}function invalidateQueries(e){console.log("Invalidating queries:",e)}async function prefetchQuery(e){const t=JSON.stringify(e.key);if(!queryCache.isStale(t,e.staleTime||0)){const e=queryCache.get(t);if(e?.data)return e.data}try{const n=await e.fetcher();return queryCache.set(t,n),n}catch(e){const n=e instanceof Error?e:new Error(String(e));throw queryCache.set(t,void 0,n),n}}const contextStack=new Map;function createContext(e){const t=Symbol("context");contextStack.set(t,[e]);return{id:t,defaultValue:e,Provider:n=>{const{value:r,children:s}=n;return(contextStack.get(t)||[e]).push(r),"undefined"==typeof window?{type:ContextBoundary,props:{contextId:t,children:s}}:s},Consumer:n=>{const r=contextStack.get(t)||[e],s=r[r.length-1];return n.children(s)}}}function useContext(e){const t=contextStack.get(e.id)||[e.defaultValue];return t[t.length-1]}function ContextBoundary(e){return e.children}function createSignalContext(e){const t=signal(e),n=createContext({get:()=>t(),set:e=>t.set(e),subscribe:t.subscribe});return{...n,useValue:()=>useContext(n).get(),setValue:e=>{useContext(n).set(e)}}}function createReducerContext(e,t){"undefined"!=typeof process&&"production"!==process.env?.NODE_ENV&&console.warn("[PhilJS] DEPRECATION WARNING: createReducerContext() is deprecated.\nUse signal() and createSignalContext() instead for simpler state management.\nThis function will be removed in v1.0.0.\nSee: https://philjs.dev/docs/migration/from-redux");const n=signal(t),r=createContext({getState:()=>n(),dispatch:t=>{const r=n(),s=e(r,t);n.set(s)},subscribe:n.subscribe});return{...r,useSelector:e=>e(useContext(r).getState()),useDispatch:()=>useContext(r).dispatch}}function combineProviders(...e){return t=>e.reduceRight((e,{Provider:t,value:n})=>t({value:n,children:e}),t.children)}function createThemeContext(e){const t=signal(e),n=createContext({get:()=>t(),set:e=>t.set(e),subscribe:t.subscribe});return{...n,ThemeProvider:e=>{t.set(e.theme);return{type:"div",props:{style:Object.entries(e.theme).map(([e,t])=>`--${e}: ${t};`).join(" "),children:n.Provider({value:{get:()=>e.theme,set:e=>t.set(e),subscribe:t.subscribe},children:e.children})}}},useTheme:()=>t()}}const easings={linear:e=>e,easeIn:e=>e*e,easeOut:e=>e*(2-e),easeInOut:e=>e<.5?2*e*e:(4-2*e)*e-1,easeInCubic:e=>e*e*e,easeOutCubic:e=>1+--e*e*e,easeInOutCubic:e=>e<.5?4*e*e*e:1+4*--e*e*e,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1- --e*e*e*e,easeInOutQuart:e=>e<.5?8*e*e*e*e:1-8*--e*e*e*e,bounce:e=>{const t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375}};function createAnimatedValue(e,t={}){const n=signal(e),r=signal(0),s=signal(!1);let a=null;return{get value(){return n()},get target(){return n()},get velocity(){return r()},get isAnimating(){return s()},set:(e,o)=>{((e,o,i=t)=>{a&&cancelAnimationFrame(a),s.set(!0);const c=performance.now();if(i.easing&&"object"==typeof i.easing){const t=i.easing,c=t.stiffness??.15,u=t.damping??.8,l=t.mass??1,d=t.restVelocity??.001,f=t.restDistance??.001;let g=e,m=r();const h=()=>{const e=o-g;if(m+=(e*c+-m*u)/l,g+=m,n.set(g),r.set(m),i.onUpdate?.(g),Math.abs(m)<d&&Math.abs(e)<f)return n.set(o),r.set(0),s.set(!1),void i.onComplete?.();a=requestAnimationFrame(h)};a=requestAnimationFrame(h)}else{const t=i.duration??300,r="function"==typeof i.easing?i.easing:easings.easeInOut,u=()=>{const l=performance.now()-c,d=Math.min(l/t,1),f=r(d),g=e+(o-e)*f;if(n.set(g),i.onUpdate?.(g),d>=1)return s.set(!1),void i.onComplete?.();a=requestAnimationFrame(u)};a=requestAnimationFrame(u)}})(n(),e,o||t)},stop:()=>{a&&(cancelAnimationFrame(a),a=null),s.set(!1)},subscribe:n.subscribe}}class FLIPAnimator{positions=new Map;recordPositions(e="[data-flip]"){document.querySelectorAll(e).forEach(e=>{const t=e.dataset.flipId||e.id;t&&this.positions.set(t,e.getBoundingClientRect())})}animateChanges(e={}){document.querySelectorAll("[data-flip]").forEach(t=>{const n=t,r=n.dataset.flipId||n.id;if(!r)return;const s=this.positions.get(r);if(!s)return;const a=n.getBoundingClientRect(),o=s.left-a.left,i=s.top-a.top,c=s.width/a.width,u=s.height/a.height;n.style.transformOrigin="top left",n.style.transform=`\n        translate(${o}px, ${i}px)\n        scale(${c}, ${u})\n      `,n.getBoundingClientRect(),n.style.transition=`transform ${e.duration||300}ms ${e.easing||"ease-in-out"}`,n.style.transform="",n.addEventListener("transitionend",()=>{n.style.transition="",n.style.transformOrigin=""},{once:!0})}),this.positions.clear()}}function attachGestures(e,t){let n=!1,r=0,s=0,a=0,o=null;const i=e=>{n=!0,r=e.clientX,s=e.clientY,t.onDragStart?.(e),o=setTimeout(()=>{t.onLongPress?.(),o=null},500)},c=e=>{if(!n)return;o&&(clearTimeout(o),o=null);const a=e.clientX-r,i=e.clientY-s;t.onDrag?.(e,{x:a,y:i})},u=e=>{if(!n)return;o&&(clearTimeout(o),o=null);const i=e.clientX-r,c=e.clientY-s;if(Math.abs(i)>50||Math.abs(c)>50)Math.abs(i)>Math.abs(c)?t.onSwipe?.(i>0?"right":"left"):t.onSwipe?.(c>0?"down":"up");else{const e=Date.now();e-a<300?t.onDoubleTap?.():t.onTap?.(),a=e}n=!1,t.onDragEnd?.(e)};return e.addEventListener("pointerdown",i),e.addEventListener("pointermove",c),e.addEventListener("pointerup",u),e.addEventListener("pointercancel",u),()=>{e.removeEventListener("pointerdown",i),e.removeEventListener("pointermove",c),e.removeEventListener("pointerup",u),e.removeEventListener("pointercancel",u),o&&clearTimeout(o)}}function createParallax(e,t={}){const{speed:n=.5,offset:r=0,axis:s="y"}=t,a=()=>{const t=window.scrollY,a=window.scrollX,o="x"!==s?(t-r)*n:0,i="y"!==s?(a-r)*n:0;e.style.transform=`translate(${i}px, ${o}px)`};return window.addEventListener("scroll",a),a(),()=>window.removeEventListener("scroll",a)}const I18nContext=createContext(null);function I18nProvider(e){const{config:t}=e,n=signal(detectLocale(t)),r={locale:()=>n(),setLocale:e=>n.set(e),t:(e,r)=>{const s=n();let a=getNestedTranslation(t.messages[s],e);return!a&&t.fallbackLocale&&(a=getNestedTranslation(t.messages[t.fallbackLocale],e)),a?(void 0!==r?.count&&(a=handlePluralization(a,r.count,s)),r?.vars&&(a=interpolate(a,r.vars)),a):(console.warn(`Missing translation for key: ${e} (locale: ${s})`),e)},formatDate:(e,t)=>new Intl.DateTimeFormat(n(),t).format(e),formatNumber:(e,t)=>new Intl.NumberFormat(n(),t).format(e),formatCurrency:(e,t)=>new Intl.NumberFormat(n(),{style:"currency",currency:t}).format(e),getAvailableLocales:()=>t.locales};return I18nContext.Provider({value:r,children:e.children})}function useI18n(){const e=useContext(I18nContext);if(!e)throw new Error("useI18n must be used within I18nProvider");return e}function useTranslation(){const{t:e}=useI18n();return e}function detectLocale(e){if(!e.autoDetect)return e.defaultLocale;if("undefined"==typeof window)return e.defaultLocale;const t=extractLocaleFromPath(window.location.pathname,e.routePattern);if(t&&e.locales.includes(t))return t;const n=localStorage.getItem("philjs_locale");if(n&&e.locales.includes(n))return n;const r=navigator.language.split("-")[0];return e.locales.includes(r)?r:e.defaultLocale}function extractLocaleFromPath(e,t){if(!t)return null;const n=e.match(/^\/([a-z]{2}(?:-[A-Z]{2})?)\//);return n?n[1]:null}function getNestedTranslation(e,t){const n=t.split(".");let r=e;for(const e of n){if(!r||"object"!=typeof r||!(e in r))return null;r=r[e]}return"string"==typeof r?r:null}function handlePluralization(e,t,n){try{const r=JSON.parse(e),s=new Intl.PluralRules(n);return r[s.select(t)]||r.other}catch{return e}}function interpolate(e,t){return e.replace(/\{(\w+)\}/g,(e,n)=>n in t?String(t[n]):`{${n}}`)}class TranslationExtractor{keys=new Set;usage=new Map;extractFromCode(e,t){const n=/\bt\s*\(\s*['"`]([^'"`]+)['"`]/g;let r,s=1;for(let a=0;a<e.length;a++){"\n"===e[a]&&s++;const o=e.slice(a);if(r=n.exec(o),r){const e=r[1];this.keys.add(e);const n=this.usage.get(e)||[];n.push({file:t,line:s}),this.usage.set(e,n),a+=r[0].length-1}}}generateTemplate(e){const t={};for(const n of this.keys)setNestedKey(t,n,`[Missing translation: "${n}" (${e})]`);return t}getKeys(){return Array.from(this.keys).sort()}getUsage(e){return this.usage.get(e)||[]}findMissing(e){const t=[];for(const n of this.keys)getNestedTranslation(e,n)||t.push(n);return t}findUnused(e){const t=[],n=flattenKeys(e);for(const e of n)this.keys.has(e)||t.push(e);return t}}function setNestedKey(e,t,n){const r=t.split(".");let s=e;for(let e=0;e<r.length-1;e++){const t=r[e];t in s||(s[t]={}),s=s[t]}s[r[r.length-1]]=n}function flattenKeys(e,t=""){const n=[];for(const[r,s]of Object.entries(e)){const e=t?`${t}.${r}`:r;"string"==typeof s?n.push(e):n.push(...flattenKeys(s,e))}return n}class AITranslationService{apiKey;constructor(e){this.apiKey=e}async translate(e,t,n){return console.log(`Translating "${e}" from ${t} to ${n}`),`[AI Translation: ${e} -> ${n}]`}async translateBatch(e,t,n,r){const s={};for(const a of e){const e=getNestedTranslation(t,a);if(e){setNestedKey(s,a,await this.translate(e,n,r))}}return s}async suggestImprovements(e,t,n){return["Alternative 1: [Improved version]","Alternative 2: [Contextual version]"]}}function createLocaleMiddleware(e){return t=>{const n=extractLocaleFromPath(new URL(t.url).pathname,e.routePattern);if(n&&e.locales.includes(n))return n;const r=t.headers.get("Accept-Language");if(r){const t=r.split(",")[0].split("-")[0].toLowerCase();if(e.locales.includes(t))return t}return e.defaultLocale}}function ErrorBoundary(e){const t=signal(null),n=signal(0),r=()=>{n.set(n()+1),t.set(null),e.onRecover?.()},s=t();if(s)return e.fallback?e.fallback(s,r):DefaultErrorFallback({error:s,retry:r,boundaryName:e.name});try{return e.children}catch(n){return((n,r)=>{const s=analyzeError(n,r);t.set(s),e.onError?.(s),logError(s,e.name)})(n),null}}function analyzeError(e,t){const n=categorizeError(e),r=generateSuggestions(e,n);return{error:e,componentStack:t,source:extractErrorSource(e),category:n,suggestions:r}}function categorizeError(e){const t=e.message.toLowerCase();return t.includes("fetch")||t.includes("network")?"network":t.includes("permission")||t.includes("denied")?"permission":t.includes("type")||t.includes("undefined")?"type":t.includes("render")||e.stack?.includes("render")?"render":"unknown"}function generateSuggestions(e,t){const n=[];if(e.message.includes("Cannot read property")||e.message.includes("undefined")){const t=e.message.match(/Cannot read propert(?:y|ies) '(\w+)' of (undefined|null)/);if(t){const e=t[1];n.push({description:`Add optional chaining to safely access '${e}'`,codeChange:{before:`obj.${e}`,after:`obj?.${e}`},confidence:.9,autoFixable:!0}),n.push({description:`Add null check before accessing '${e}'`,codeChange:{before:`obj.${e}`,after:`obj && obj.${e}`},confidence:.8,autoFixable:!0})}}return e.message.includes("is not a function")&&(n.push({description:"Check if the function is properly imported and defined",confidence:.7,autoFixable:!1}),n.push({description:"Ensure the function is not being called before it's declared",confidence:.6,autoFixable:!1})),"network"===t&&(n.push({description:"Add error handling for network requests",codeChange:{before:"const data = await fetch(url).then(r => r.json())",after:"try {\n  const data = await fetch(url).then(r => r.json())\n} catch (err) {\n  console.error('Fetch failed:', err)\n}"},confidence:.85,autoFixable:!0}),n.push({description:"Check network connection and API endpoint",confidence:.7,autoFixable:!1})),"render"===t&&(n.push({description:"Check if all required props are provided",confidence:.75,autoFixable:!1}),n.push({description:"Ensure JSX syntax is valid and properly closed",confidence:.7,autoFixable:!1})),n.sort((e,t)=>t.confidence-e.confidence)}function extractErrorSource(e){if(!e.stack)return;const t=e.stack.split("\n");for(const e of t){const t=e.match(/at\s+(?:.*\s+)?\(?(.+):(\d+):(\d+)\)?/);if(t)return{file:t[1],line:parseInt(t[2],10),column:parseInt(t[3],10)}}}function DefaultErrorFallback(e){const{error:t,retry:n,boundaryName:r}=e;return createElement("div",{style:{padding:"2rem",background:"#fee",border:"2px solid #c33",borderRadius:"8px",fontFamily:"monospace"}},createElement("h2",{style:{color:"#c33",marginBottom:"1rem"}},`âš ï¸ Error in ${r||"Component"}`),createElement("div",{style:{background:"white",padding:"1rem",borderRadius:"4px",marginBottom:"1rem"}},createElement("strong",{},"Error:")," ",t.error.message),t.source&&createElement("div",{style:{marginBottom:"1rem",fontSize:"0.9rem"}},createElement("strong",{},"Location:"),` ${t.source.file}:${t.source.line}:${t.source.column}`),t.suggestions.length>0&&createElement("div",{style:{marginBottom:"1rem"}},createElement("h3",{style:{marginBottom:"0.5rem"}},"ðŸ’¡ Suggested Fixes:"),createElement("ul",{style:{margin:0,paddingLeft:"1.5rem"}},...t.suggestions.map((e,t)=>createElement("li",{key:t,style:{marginBottom:"0.5rem"}},e.description,e.autoFixable&&createElement("span",{style:{color:"#28a745",marginLeft:"0.5rem"}},"(Auto-fixable)"),createElement("br",{}),createElement("small",{style:{color:"#666"}},`Confidence: ${(100*e.confidence).toFixed(0)}%`))))),createElement("button",{onClick:n,style:{padding:"0.5rem 1rem",background:"#667eea",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"1rem"}},"ðŸ”„ Retry"),"development"===process.env.NODE_ENV&&t.componentStack&&createElement("details",{style:{marginTop:"1rem"}},createElement("summary",{style:{cursor:"pointer"}},"Component Stack"),createElement("pre",{style:{background:"white",padding:"1rem",borderRadius:"4px",overflow:"auto",fontSize:"0.85rem"}},t.componentStack)))}function logError(e,t){console.error(`[ErrorBoundary${t?` ${t}`:""}]`,{message:e.error.message,stack:e.error.stack,category:e.category,source:e.source,suggestions:e.suggestions}),"undefined"!=typeof window&&window.analytics&&window.analytics.track("Error Caught",{category:e.category,message:e.error.message,boundaryName:t})}function setupGlobalErrorHandler(e){const t=t=>{const n=analyzeError(t.error||new Error(t.message));e(n)},n=t=>{const n=analyzeError(t.reason instanceof Error?t.reason:new Error(String(t.reason)));e(n)};return window.addEventListener("error",t),window.addEventListener("unhandledrejection",n),()=>{window.removeEventListener("error",t),window.removeEventListener("unhandledrejection",n)}}class ErrorRecovery{recoveryStrategies=new Map;constructor(){this.setupDefaultStrategies()}setupDefaultStrategies(){this.addStrategy("network",{name:"Exponential Backoff Retry",execute:async(e,t)=>{let n=1e3;for(let e=0;e<3;e++){await new Promise(e=>setTimeout(e,n));try{return await t.retry()}catch(t){if(2===e)throw t;n*=2}}},shouldApply:e=>e.message.includes("fetch")||e.message.includes("network")}),this.addStrategy("type",{name:"Fallback Value",execute:async(e,t)=>t.fallbackValue??null,shouldApply:e=>e.message.includes("undefined")||e.message.includes("null")})}addStrategy(e,t){const n=this.recoveryStrategies.get(e)||[];n.push(t),this.recoveryStrategies.set(e,n)}async recover(e,t,n){const r=this.recoveryStrategies.get(t)||[];for(const t of r)if(t.shouldApply(e))try{return await t.execute(e,n)}catch(e){console.error(`Recovery strategy "${t.name}" failed:`,e)}throw e}}const errorRecovery=new ErrorRecovery;function generateServiceWorker(e){return`\n// PhilJS Service Worker - Generated\n// Version: ${Date.now()}\n\nconst CACHE_VERSION = 'philjs-v1';\nconst PRECACHE_URLS = ${JSON.stringify(e.precache||[])};\nconst OFFLINE_FALLBACK = ${JSON.stringify(e.offlineFallback||"/offline")};\n\n// Cache rules\nconst CACHE_RULES = ${JSON.stringify(e.cacheRules.map(e=>({...e,pattern:e.pattern instanceof RegExp?e.pattern.source:e.pattern})))};\n\n// Install event - precache assets\nself.addEventListener('install', (event) => {\n  console.log('[SW] Installing service worker...');\n\n  event.waitUntil(\n    caches.open(CACHE_VERSION).then((cache) => {\n      console.log('[SW] Precaching:', PRECACHE_URLS);\n      return cache.addAll(PRECACHE_URLS);\n    })${e.skipWaiting?".then(() => self.skipWaiting())":""}\n  );\n});\n\n// Activate event - clean old caches\nself.addEventListener('activate', (event) => {\n  console.log('[SW] Activating service worker...');\n\n  event.waitUntil(\n    caches.keys().then((cacheNames) => {\n      return Promise.all(\n        cacheNames\n          .filter((name) => name !== CACHE_VERSION)\n          .map((name) => {\n            console.log('[SW] Deleting old cache:', name);\n            return caches.delete(name);\n          })\n      );\n    })${e.clientsClaim?".then(() => self.clients.claim())":""}\n  );\n});\n\n// Fetch event - handle requests\nself.addEventListener('fetch', (event) => {\n  const { request } = event;\n  const url = new URL(request.url);\n\n  // Skip cross-origin requests\n  if (url.origin !== self.location.origin) {\n    return;\n  }\n\n  // Find matching cache rule\n  const rule = CACHE_RULES.find((r) => {\n    const pattern = typeof r.pattern === 'string'\n      ? new RegExp(r.pattern)\n      : new RegExp(r.pattern);\n    return pattern.test(url.pathname);\n  });\n\n  if (!rule) {\n    return; // No rule, let browser handle it\n  }\n\n  const strategy = rule.strategy;\n  const cacheName = rule.cacheName || CACHE_VERSION;\n\n  event.respondWith(\n    handleRequest(request, strategy, cacheName, rule.maxAge)\n      .catch(() => {\n        // Fallback to offline page for navigation requests\n        if (request.mode === 'navigate') {\n          return caches.match(OFFLINE_FALLBACK);\n        }\n        throw new Error('No cache match');\n      })\n  );\n});\n\n// Handle request with strategy\nasync function handleRequest(request, strategy, cacheName, maxAge) {\n  switch (strategy) {\n    case 'network-first':\n      return networkFirst(request, cacheName, maxAge);\n    case 'cache-first':\n      return cacheFirst(request, cacheName, maxAge);\n    case 'stale-while-revalidate':\n      return staleWhileRevalidate(request, cacheName, maxAge);\n    case 'network-only':\n      return fetch(request);\n    case 'cache-only':\n      return caches.match(request);\n    default:\n      return fetch(request);\n  }\n}\n\n// Network first strategy\nasync function networkFirst(request, cacheName, maxAge) {\n  try {\n    const response = await fetch(request);\n    if (response.ok) {\n      const cache = await caches.open(cacheName);\n      cache.put(request, response.clone());\n    }\n    return response;\n  } catch (error) {\n    const cached = await caches.match(request);\n    if (cached) return cached;\n    throw error;\n  }\n}\n\n// Cache first strategy\nasync function cacheFirst(request, cacheName, maxAge) {\n  const cached = await caches.match(request);\n\n  if (cached) {\n    // Check if expired\n    if (maxAge) {\n      const date = cached.headers.get('date');\n      if (date) {\n        const age = (Date.now() - new Date(date).getTime()) / 1000;\n        if (age > maxAge) {\n          // Expired, fetch new\n          return networkFirst(request, cacheName, maxAge);\n        }\n      }\n    }\n    return cached;\n  }\n\n  return networkFirst(request, cacheName, maxAge);\n}\n\n// Stale while revalidate strategy\nasync function staleWhileRevalidate(request, cacheName, maxAge) {\n  const cache = await caches.open(cacheName);\n  const cached = await cache.match(request);\n\n  // Always fetch in background\n  const fetchPromise = fetch(request).then((response) => {\n    if (response.ok) {\n      cache.put(request, response.clone());\n    }\n    return response;\n  });\n\n  // Return cached if available, otherwise wait for fetch\n  return cached || fetchPromise;\n}\n\n${e.backgroundSync?generateBackgroundSync():""}\n\n${e.pushNotifications?generatePushNotifications():""}\n\nconsole.log('[SW] Service worker ready');\n`.trim()}function generateBackgroundSync(){return"\n// Background sync\nself.addEventListener('sync', (event) => {\n  console.log('[SW] Background sync:', event.tag);\n\n  if (event.tag === 'sync-data') {\n    event.waitUntil(syncData());\n  }\n});\n\nasync function syncData() {\n  // Sync queued requests when back online\n  const queue = await getQueue();\n  for (const request of queue) {\n    try {\n      await fetch(request);\n      await removeFromQueue(request);\n    } catch (error) {\n      console.error('[SW] Sync failed:', error);\n    }\n  }\n}\n\nasync function getQueue() {\n  // Implementation would use IndexedDB\n  return [];\n}\n\nasync function removeFromQueue(request) {\n  // Implementation would use IndexedDB\n}\n"}function generatePushNotifications(){return"\n// Push notifications\nself.addEventListener('push', (event) => {\n  const data = event.data?.json() || {};\n\n  const options = {\n    body: data.body || 'New notification',\n    icon: data.icon || '/icon.png',\n    badge: data.badge || '/badge.png',\n    data: data.data || {},\n  };\n\n  event.waitUntil(\n    self.registration.showNotification(data.title || 'PhilJS App', options)\n  );\n});\n\nself.addEventListener('notificationclick', (event) => {\n  event.notification.close();\n\n  event.waitUntil(\n    clients.openWindow(event.notification.data.url || '/')\n  );\n});\n"}const defaultCacheRules=[{pattern:/\.(js|css|woff2?)$/,strategy:"cache-first",cacheName:"static-assets",maxAge:2592e3},{pattern:/\.(png|jpg|jpeg|svg|gif|webp|avif)$/,strategy:"cache-first",cacheName:"images",maxAge:604800,maxEntries:50},{pattern:/\/api\//,strategy:"network-first",cacheName:"api-data",maxAge:60},{pattern:/\.html$/,strategy:"stale-while-revalidate",cacheName:"pages",maxAge:86400}];async function registerServiceWorker(e="/sw.js",t={}){if("undefined"!=typeof window&&"serviceWorker"in navigator)try{const n=await navigator.serviceWorker.register(e);return n.addEventListener("updatefound",()=>{const e=n.installing;e&&e.addEventListener("statechange",()=>{"installed"===e.state&&navigator.serviceWorker.controller&&t.onUpdate?.(n)})}),t.onSuccess?.(n),n}catch(e){return void t.onError?.(e)}else console.warn("Service workers not supported")}async function unregisterServiceWorkers(){if("undefined"==typeof window||!("serviceWorker"in navigator))return;const e=await navigator.serviceWorker.getRegistrations();await Promise.all(e.map(e=>e.unregister()))}function skipWaitingAndClaim(){"undefined"!=typeof self&&"skipWaiting"in self&&(self.skipWaiting(),self.clients.claim())}class PerformanceBudgetManager{budgets=new Map;history=new Map;baseline=null;setBudget(e,t){this.budgets.set(e,t)}setDefaultBudget(e){this.budgets.set("*",e)}checkBudget(e){const t=this.budgets.get(e.route)||this.budgets.get("*");if(!t)return{passed:!0,violations:[]};const n=[];for(const[r,s]of Object.entries(t)){const t=e.metrics[r];t&&"number"==typeof t&&t>s&&n.push({metric:r,budget:s,actual:t,excess:t-s})}return{passed:0===n.length,violations:n}}detectRegressions(e){const t=this.history.get(e.route)||[];if(0===t.length)return[];const n=t[t.length-1],r=[];for(const[t,s]of Object.entries(e.metrics)){if("number"!=typeof s)continue;const a=n.metrics[t];if("number"!=typeof a)continue;const o=s-a,i=o/a*100;if(o>0){const c=this.calculateSeverity(t,i),u=this.generateSuggestions(t,e,n);r.push({route:e.route,metric:t,previousValue:a,currentValue:s,change:o,percentChange:i,severity:c,suggestions:u})}}return r}calculateSeverity(e,t){const n={bundleSize:{low:5,medium:10,high:20},lcp:{low:10,medium:20,high:50},cls:{low:20,medium:50,high:100},renderTime:{low:15,medium:30,high:50}}[e]||{low:10,medium:25,high:50};return t>=n.high?"critical":t>=n.medium?"high":t>=n.low?"medium":"low"}generateSuggestions(e,t,n){const r=[],s=t.dependencies.filter(e=>!n.dependencies.includes(e));return n.dependencies.filter(e=>!t.dependencies.includes(e)),"bundleSize"===e&&s.length>0&&r.push(`New dependencies added: ${s.join(", ")}. Consider lazy loading or using lighter alternatives.`),"lcp"===e&&r.push("Consider optimizing critical rendering path","Preload critical resources","Reduce server response time"),"cls"===e&&r.push("Add size attributes to images and videos","Avoid inserting content above existing content","Use CSS transform instead of position changes"),"renderTime"===e&&r.push("Optimize component rendering with memoization","Reduce unnecessary re-renders","Consider virtualization for large lists"),r}recordMetrics(e){const t=this.history.get(e.route)||[];t.push(e),t.length>100&&t.shift(),this.history.set(e.route,t)}getTrends(e,t=30){const n=this.history.get(e)||[],r=Date.now()-24*t*60*60*1e3,s=n.filter(e=>e.timestamp>r);if(s.length<2)return[];const a=[];for(const e of Object.keys(s[0].metrics)){const n=s.map(t=>({timestamp:t.timestamp,value:t.metrics[e]})).filter(e=>"number"==typeof e.value);if(n.length<2)continue;const r=n.length,o=n.reduce((e,t)=>e+t.timestamp,0),i=n.reduce((e,t)=>e+t.value,0),c=(r*n.reduce((e,t)=>e+t.timestamp*t.value,0)-o*i)/(r*n.reduce((e,t)=>e+t.timestamp*t.timestamp,0)-o*o)*t*24*60*60*1e3;let u;u=Math.abs(c)<.01?"stable":c>0?"degrading":"improving",a.push({metric:e,trend:u,change:c,dataPoints:n})}return a}exportMetrics(){return{budgets:Object.fromEntries(this.budgets),history:Object.fromEntries(this.history)}}importMetrics(e){this.budgets=new Map(Object.entries(e.budgets)),this.history=new Map(Object.entries(e.history))}}const performanceBudgets=new PerformanceBudgetManager;function performanceBudgetPlugin(e){return{name:"performance-budget",generateBundle(t,n){for(const[t,r]of Object.entries(n)){const n={route:t,timestamp:Date.now(),metrics:{bundleSize:r.code?.length||0,compressedSize:0,requestCount:1,totalRequestSize:r.code?.length||0},dependencies:r.imports||[],criticalPath:[]},s=performanceBudgets.checkBudget(n);if(!s.passed){const n=`Performance budget violations in ${t}:\n${s.violations.map(e=>`  - ${e.metric}: ${e.actual} (budget: ${e.budget}, excess: ${e.excess})`).join("\n")}`;if(e.failOnViolation&&!e.warnOnly)throw new Error(n);console.warn(n)}performanceBudgets.recordMetrics(n)}}}}const PRICING_MODELS={aws:{lambda:{compute:166667e-10,requests:.2/1e6,dataTransfer:.09/1024},dynamodb:{read:25e-8,write:125e-8}},cloudflare:{workers:{compute:1e-5,requests:5e-7,dataTransfer:0},kv:{read:5e-7,write:5e-6}},vercel:{functions:{compute:2e-7,requests:6e-7,dataTransfer:.15/1024}},gcp:{functions:{compute:25e-7,requests:.4/1e6,dataTransfer:.12/1024}},azure:{functions:{compute:16e-6,requests:.2/1e6,dataTransfer:.087/1024}}};class CostTracker{provider;metrics=new Map;customPricing=null;constructor(e="cloudflare"){this.provider=e}setProvider(e){this.provider=e}setCustomPricing(e){this.customPricing=e}trackRoute(e,t){const n=this.metrics.get(e)||[];n.push(t),n.length>1e4&&n.shift(),this.metrics.set(e,n)}estimateCost(e){const t=this.metrics.get(e)||[];if(0===t.length)return{total:0,breakdown:{compute:0,memory:0,dataTransfer:0},perThousandRequests:0,monthlyProjection:0,optimizations:[]};const n=this.calculateAverageMetrics(t),r=this.customPricing||PRICING_MODELS[this.provider],s=this.calculateComputeCost(n,r),a=this.calculateMemoryCost(n,r),o=this.calculateDataTransferCost(n,r),i=this.calculateDatabaseCost(n,r),c=this.calculateCacheCost(n,r),u=s+a+o+i+c;return{total:u,breakdown:{compute:s,memory:a,dataTransfer:o,database:i,cache:c},perThousandRequests:1e3*u,monthlyProjection:u*(30*t.length),optimizations:this.generateOptimizations(n,{computeCost:s,memoryCost:a,dataTransferCost:o,dbCost:i,cacheCost:c})}}calculateAverageMetrics(e){const t=e.reduce((e,t)=>({computeTime:e.computeTime+t.computeTime,memoryUsed:e.memoryUsed+t.memoryUsed,dataTransfer:e.dataTransfer+t.dataTransfer,invocations:e.invocations+t.invocations,dbQueries:(e.dbQueries||0)+(t.dbQueries||0),cacheHits:(e.cacheHits||0)+(t.cacheHits||0),cacheMisses:(e.cacheMisses||0)+(t.cacheMisses||0),externalApiCalls:(e.externalApiCalls||0)+(t.externalApiCalls||0)}),{computeTime:0,memoryUsed:0,dataTransfer:0,invocations:0,dbQueries:0,cacheHits:0,cacheMisses:0,externalApiCalls:0}),n=e.length;return{computeTime:t.computeTime/n,memoryUsed:t.memoryUsed/n,dataTransfer:t.dataTransfer/n,invocations:t.invocations/n,dbQueries:t.dbQueries?t.dbQueries/n:void 0,cacheHits:t.cacheHits?t.cacheHits/n:void 0,cacheMisses:t.cacheMisses?t.cacheMisses/n:void 0,externalApiCalls:t.externalApiCalls?t.externalApiCalls/n:void 0}}calculateComputeCost(e,t){if("aws"===this.provider||"azure"===this.provider){return e.memoryUsed/1024*(e.computeTime/1e3)*(t.lambda?.compute||t.functions?.compute||0)}return e.computeTime*(t.workers?.compute||t.functions?.compute||0)}calculateMemoryCost(e,t){return 0}calculateDataTransferCost(e,t){return e.dataTransfer/1048576*(t.lambda?.dataTransfer||t.workers?.dataTransfer||t.functions?.dataTransfer||0)}calculateDatabaseCost(e,t){if(!e.dbQueries)return 0;const n=t.dynamodb?.read||t.kv?.read||0,r=t.dynamodb?.write||t.kv?.write||0;return e.dbQueries*(.8*n+.2*r)}calculateCacheCost(e,t){if(!e.cacheHits||!e.cacheMisses)return 0;const n=t.cache?.hit||0,r=t.cache?.miss||0;return e.cacheHits*n+e.cacheMisses*r}generateOptimizations(e,t){const n=[];if(e.computeTime>1e3&&n.push({category:"compute",potentialSavings:.3*t.compute,suggestion:"Consider optimizing algorithm complexity or using caching",difficulty:"medium"}),e.memoryUsed>512&&n.push({category:"memory",potentialSavings:.2*t.memory,suggestion:"Reduce memory usage by streaming data or using smaller data structures",difficulty:"medium"}),e.dataTransfer>102400&&n.push({category:"dataTransfer",potentialSavings:.4*t.dataTransfer,suggestion:"Enable compression, use CDN, or reduce payload size",difficulty:"easy"}),e.dbQueries&&e.dbQueries>10&&n.push({category:"database",potentialSavings:.5*t.database,suggestion:"Batch queries, use caching, or denormalize data",difficulty:"medium"}),e.cacheMisses&&e.cacheHits){const r=e.cacheHits/(e.cacheHits+e.cacheMisses);r<.8&&n.push({category:"cache",potentialSavings:.3*t.cache,suggestion:`Improve cache hit rate (currently ${(100*r).toFixed(1)}%)`,difficulty:"easy"})}return n.sort((e,t)=>t.potentialSavings-e.potentialSavings)}getCostTrends(e,t=30){const n=this.metrics.get(e)||[],r=[],s=new Map,a=Date.now(),o=a-24*t*60*60*1e3;for(const e of n){const t=a;if(t<o)continue;const n=new Date(t).toISOString().split("T")[0],r=s.get(n)||[];r.push(e),s.set(n,r)}for(const[t,n]of s){const s=this.estimateCost(e);r.push({date:t,cost:s.total*n.length,breakdown:s.breakdown})}return r}exportCostData(){const e={};for(const[t,n]of this.metrics)e[t]={metrics:n,estimate:this.estimateCost(t)};return e}}const costTracker=new CostTracker;class UsageAnalytics{usage=new Map;renderTimes=new Map;propPatterns=new Map;productionMode=!1;trackImport(e,t,n){const r=this.getOrCreateUsage(e);r.importCount++,r.importedBy.includes(t)||r.importedBy.push(t),n&&r.usedInRoutes.add(n);const s=this.getOrCreateUsage(t);s.dependencies.includes(e)||s.dependencies.push(e)}trackRender(e,t,n,r){const s=this.getOrCreateUsage(e);s.renderCount++,s.lastUsed=Date.now(),s.usedInRoutes.add(r);const a=this.renderTimes.get(e)||[];a.push(n),a.length>1e3&&a.shift(),this.renderTimes.set(e,a),s.avgRenderTime=a.reduce((e,t)=>e+t,0)/a.length,this.trackPropUsage(e,t)}trackPropUsage(e,t){const n=this.getOrCreateUsage(e);for(const[r,s]of Object.entries(t)){const t=this.propPatterns.get(e)||new Map,a=t.get(r)||[];a.push(s),a.length>1e3&&a.shift(),t.set(r,a),this.propPatterns.set(e,t);const o=JSON.stringify(s);let i=n.propsUsage.get(r);i||(i=new Map,n.propsUsage.set(r,i));const c=Array.from(i.entries()).find(([e])=>JSON.stringify(e)===o);c?c[1].count++:i.set(s,{value:s,count:1,percentage:0})}for(const[e,t]of n.propsUsage){const e=Array.from(t.values()).reduce((e,t)=>e+t.count,0);for(const n of t.values())n.percentage=n.count/e*100}}getOrCreateUsage(e){return this.usage.has(e)||this.usage.set(e,{component:e,importCount:0,renderCount:0,usedInRoutes:new Set,propsUsage:new Map,avgRenderTime:0,bundleSize:0,lastUsed:Date.now(),dependencies:[],importedBy:[],isActive:!0}),this.usage.get(e)}detectDeadCode(e={}){const{inactivityThreshold:t=30,minConfidence:n=.7}=e,r=[],s=Date.now(),a=s-24*t*60*60*1e3;for(const[e,t]of this.usage){let o=null,i=0,c="";if(0===t.renderCount&&t.importCount>0)o="never-rendered",i=.9,c=`Component imported ${t.importCount} times but never rendered. Safe to remove.`;else if(t.lastUsed<a){o="not-used-recently",i=.7;c=`Not used in ${Math.floor((s-t.lastUsed)/864e5)} days. Consider removing or archiving.`}else t.importedBy.every(e=>{const t=this.usage.get(e);return t&&0===t.renderCount})?(o="only-imported",i=.8,c="Only imported by components that are themselves unused."):this.hasCircularDependency(e)&&(o="circular-dependency",i=.6,c="Part of circular dependency chain. Refactor to break cycle.");o&&i>=n&&r.push({component:e,reason:o,lastUsed:t.lastUsed,importedBy:t.importedBy,suggestion:c,confidence:i})}return r.sort((e,t)=>t.confidence-e.confidence)}hasCircularDependency(e,t=new Set){if(t.has(e))return!0;t.add(e);const n=this.usage.get(e);if(!n)return!1;for(const e of n.dependencies)if(this.hasCircularDependency(e,new Set(t)))return!0;return!1}generateOptimizations(){const e=[];for(const[t,n]of this.usage){for(const[r,s]of n.propsUsage){const n=Array.from(s.values()).sort((e,t)=>t.count-e.count)[0];n&&n.percentage>80&&e.push({component:t,type:"default-prop",description:`${n.percentage.toFixed(1)}% of uses pass "${n.value}" for prop "${r}". Consider making it the default.`,impact:"low",autoFixAvailable:!0,codeChanges:[{file:t,before:`function ${t}({ ${r}, ...props })`,after:`function ${t}({ ${r} = ${JSON.stringify(n.value)}, ...props })`}]})}n.avgRenderTime>16&&e.push({component:t,type:"memo",description:`Average render time is ${n.avgRenderTime.toFixed(2)}ms. Consider memoization.`,impact:"high",autoFixAvailable:!0,codeChanges:[{file:t,before:`export function ${t}`,after:`export const ${t} = memo(function ${t}`}]}),n.bundleSize>5e4&&n.renderCount<.1*n.importCount&&e.push({component:t,type:"lazy-load",description:`Large component (${(n.bundleSize/1024).toFixed(1)}KB) rarely rendered. Consider lazy loading.`,impact:"high",autoFixAvailable:!0,codeChanges:[{file:"imports",before:`import { ${t} } from './components/${t}'`,after:`const ${t} = lazy(() => import('./components/${t}'))`}]});const r=n.dependencies.filter(e=>{const t=this.usage.get(e);return t&&0===t.renderCount});r.length>0&&e.push({component:t,type:"remove-dependency",description:`Remove unused dependencies: ${r.join(", ")}`,impact:"medium",autoFixAvailable:!1})}return e.sort((e,t)=>{const n={high:3,medium:2,low:1};return n[t.impact]-n[e.impact]})}getDependencyGraph(){const e=Array.from(this.usage.values()).map(e=>({id:e.component,size:e.bundleSize||e.renderCount,active:e.isActive})),t=[];for(const[e,n]of this.usage)for(const r of n.dependencies)t.push({source:e,target:r,weight:n.renderCount});return{nodes:e,edges:t}}exportUsageData(){const e={};for(const[t,n]of this.usage)e[t]={...n,usedInRoutes:new Set(n.usedInRoutes),propsUsage:new Map(n.propsUsage)};return e}generateDocumentation(e){const t=this.usage.get(e);if(!t)return"No usage data available";const n=[`# ${e}`,""];if(n.push("## Usage Statistics"),n.push(`- Imported: ${t.importCount} times`),n.push(`- Rendered: ${t.renderCount} times`),n.push(`- Average render time: ${t.avgRenderTime.toFixed(2)}ms`),n.push(`- Bundle size: ${(t.bundleSize/1024).toFixed(1)}KB`),n.push(""),t.usedInRoutes.size>0){n.push("## Used in Routes");for(const e of t.usedInRoutes)n.push(`- ${e}`);n.push("")}if(t.propsUsage.size>0){n.push("## Common Props");for(const[e,r]of t.propsUsage){const t=Array.from(r.values()).sort((e,t)=>t.count-e.count).slice(0,3);n.push(`### ${e}`);for(const e of t)n.push(`- \`${JSON.stringify(e.value)}\` (${e.percentage.toFixed(1)}%)`);n.push("")}}if(t.dependencies.length>0){n.push("## Dependencies");for(const e of t.dependencies)n.push(`- ${e}`);n.push("")}if(t.importedBy.length>0){n.push("## Imported By");for(const e of t.importedBy)n.push(`- ${e}`)}return n.join("\n")}}const usageAnalytics=new UsageAnalytics;function Ok(e){return{ok:!0,value:e}}function Err(e){return{ok:!1,error:e}}function isResult(e){return"object"==typeof e&&null!==e&&void 0!==e.ok&&"boolean"==typeof e.ok&&e.ok?"value"in e:"error"in e}function isOk(e){return e.ok}function isErr(e){return!e.ok}function map(e,t){return e.ok?Ok(t(e.value)):e}function mapErr(e,t){return e.ok?e:Err(t(e.error))}function andThen(e,t){return e.ok?t(e.value):e}function unwrap(e){if(e.ok)return e.value;throw new Error(safeErrorMessage(e.error))}function unwrapOr(e,t){return e.ok?e.value:t}function matchResult(e,t){return e.ok?t.ok(e.value):t.err(e.error)}function safeErrorMessage(e){if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch{return String(e)}}class Schema{config;constructor(e){this.config=e}required(e){return this.config.required=!0,e&&(this.config.rules=this.config.rules||[],this.config.rules.unshift({validate:e=>null!=e&&""!==e,message:e})),this}min(e,t){return this.config.rules=this.config.rules||[],this.config.rules.push({validate:t=>"string"==typeof t||Array.isArray(t)?t.length>=e:"number"==typeof t&&t>=e,message:t||(t=>"string"==typeof t?`Must be at least ${e} characters`:"number"==typeof t?`Must be at least ${e}`:`Must have at least ${e} items`)}),this}max(e,t){return this.config.rules=this.config.rules||[],this.config.rules.push({validate:t=>"string"==typeof t||Array.isArray(t)?t.length<=e:"number"==typeof t&&t<=e,message:t||(t=>"string"==typeof t?`Must be at most ${e} characters`:"number"==typeof t?`Must be at most ${e}`:`Must have at most ${e} items`)}),this}pattern(e,t){return this.config.rules=this.config.rules||[],this.config.rules.push({validate:t=>"string"==typeof t&&e.test(t),message:t||"Invalid format"}),this}email(e){return this.pattern(/^[^\s@]+@[^\s@]+\.[^\s@]+$/,e||"Invalid email address")}url(e){return this.config.rules=this.config.rules||[],this.config.rules.push({validate:e=>{if("string"!=typeof e)return!1;try{return new URL(e),!0}catch{return!1}},message:e||"Invalid URL"}),this}custom(e){return this.config.rules=this.config.rules||[],this.config.rules.push(e),this}transform(e){return this.config.transform=e,this}default(e){return this.config.defaultValue=e,this}getConfig(){return this.config}}const v={string:()=>new Schema({type:"string"}),number:()=>new Schema({type:"number",transform:e=>{const t=Number(e);return isNaN(t)?0:t}}),boolean:()=>new Schema({type:"boolean",transform:e=>!0===e||"true"===e||"on"===e}),email:()=>new Schema({type:"email"}).email(),url:()=>new Schema({type:"url"}).url(),date:()=>new Schema({type:"date",transform:e=>e instanceof Date?e:new Date(e)}),custom:e=>new Schema({type:"custom"})};function useForm(e){const{schema:t,initialValues:n,onSubmit:r,validateOnChange:s=!1,validateOnBlur:a=!0}=e,o={},i={};for(const[e,n]of Object.entries(t)){const t=n.getConfig();o[e]=t,void 0!==t.defaultValue&&(i[e]=t.defaultValue)}const c=signal({...i,...n}),u=signal({}),l=signal({}),d=signal({}),f=signal(!0),g=signal(!1),m=signal(0);async function h(e){const t=o[e];if(!t)return!0;const n=c()[e],r=[];if(!t.required||null!=n&&""!==n||r.push(`${String(e)} is required`),t.rules&&null!=n&&""!==n)for(const e of t.rules){if(!await e.validate(n)){const t="function"==typeof e.message?e.message(n):e.message;r.push(t)}}const s=u();if(r.length>0)return u.set({...s,[e]:r}),!1;{const{[e]:t,...n}=s;return u.set(n),!0}}async function p(e){if(e)return h(e);const t=(await Promise.all(Object.keys(o).map(e=>h(e)))).every(e=>e);return f.set(t),t}function y(e,t){const n=o[e];let r=t;n?.transform&&(r=n.transform(t));const a=c();c.set({...a,[e]:r});const i=d();d.set({...i,[e]:!0}),s&&h(e)}function v(e,t){const n=l();l.set({...n,[e]:t})}return{values:c,errors:u,touched:l,dirty:d,isValid:f,isSubmitting:g,submitCount:m,setValue:y,setError:function(e,t){const n=u();u.set({...n,[e]:[t]}),f.set(!1)},clearError:function(e){const t=u(),{[e]:n,...r}=t;u.set(r)},setTouched:v,validate:p,handleSubmit:async function(e){e&&e.preventDefault(),m.set(m()+1);const t={};for(const e of Object.keys(o))t[e]=!0;if(l.set(t),await p()){g.set(!0);try{await r(c())}catch(e){throw console.error("Form submission error:",e),e}finally{g.set(!1)}}},handleChange:function(e){return t=>{const n=t.target,r=o[e];let s=n.value;"number"===r?.type?s=n.valueAsNumber:"boolean"===r?.type?s=n.checked:"date"===r?.type&&(s=n.valueAsDate),r?.transform&&(s=r.transform(s)),y(e,s)}},handleBlur:function(e){return t=>{v(e,!0),a&&h(e)}},reset:function(){c.set({...i,...n}),u.set({}),l.set({}),d.set({}),f.set(!0),g.set(!1),m.set(0)}}}function createField(){return{Input:e=>{const{form:t,name:n,label:r,placeholder:s,type:a="text",className:o}=e,i=t.values()[n],c=t.errors()[n]||[],u=t.touched()[n]&&c.length>0;return{type:"div",props:{className:`field ${o||""}`.trim(),children:[r&&{type:"label",props:{htmlFor:String(n),children:r}},{type:"input",props:{id:String(n),name:String(n),type:a,value:i||"",placeholder:s,onChange:t.handleChange(n),onBlur:t.handleBlur(n),"aria-invalid":u,"aria-describedby":u?`${String(n)}-error`:void 0}},u&&{type:"div",props:{id:`${String(n)}-error`,className:"field-error",role:"alert",children:c[0]}}].filter(Boolean)}}},TextArea:e=>{const{form:t,name:n,label:r,placeholder:s,rows:a=4,className:o}=e,i=t.values()[n],c=t.errors()[n]||[],u=t.touched()[n]&&c.length>0;return{type:"div",props:{className:`field ${o||""}`.trim(),children:[r&&{type:"label",props:{htmlFor:String(n),children:r}},{type:"textarea",props:{id:String(n),name:String(n),value:i||"",placeholder:s,rows:a,onChange:t.handleChange(n),onBlur:t.handleBlur(n),"aria-invalid":u,"aria-describedby":u?`${String(n)}-error`:void 0}},u&&{type:"div",props:{id:`${String(n)}-error`,className:"field-error",role:"alert",children:c[0]}}].filter(Boolean)}}},Checkbox:e=>{const{form:t,name:n,label:r,className:s}=e,a=t.values()[n],o=t.errors()[n]||[],i=t.touched()[n]&&o.length>0;return{type:"div",props:{className:`field field-checkbox ${s||""}`.trim(),children:[{type:"label",props:{children:[{type:"input",props:{id:String(n),name:String(n),type:"checkbox",checked:!!a,onChange:t.handleChange(n),onBlur:t.handleBlur(n),"aria-invalid":i,"aria-describedby":i?`${String(n)}-error`:void 0}},r&&{type:"span",props:{children:r}}].filter(Boolean)}},i&&{type:"div",props:{id:`${String(n)}-error`,className:"field-error",role:"alert",children:o[0]}}].filter(Boolean)}}}}}let globalConfig={autoAria:!0,headingHierarchy:!0,keyboardNav:!0,colorContrast:!0,focusManagement:!0,devWarnings:"undefined"!=typeof process&&"production"!==process.env.NODE_ENV,minContrastRatio:4.5};function configureA11y(e){globalConfig={...globalConfig,...e}}function getA11yConfig(){return{...globalConfig}}const ariaPatterns={button:e=>({role:"button","aria-label":e||"Button"}),link:e=>({role:"link","aria-label":e?`Link to ${e}`:"Link"}),input:(e,t)=>({"aria-label":t||`Input field ${e||"text"}`,"aria-required":"false"}),image:e=>({role:"img","aria-label":e||"Image"}),heading:(e,t)=>({role:"heading","aria-level":String(e),"aria-label":t||`Heading level ${e}`}),list:()=>({role:"list"}),listitem:()=>({role:"listitem"}),navigation:()=>({role:"navigation","aria-label":"Navigation"}),search:()=>({role:"search","aria-label":"Search"}),dialog:e=>({role:"dialog","aria-modal":"true","aria-label":e||"Dialog"}),alert:e=>({role:"alert","aria-live":"assertive","aria-atomic":"true","aria-label":e||"Alert"})};function enhanceWithAria(e,t={}){if(!globalConfig.autoAria)return t;const n={...t};if(t.role||t["aria-label"]||t["aria-labelledby"])return n;const r=e.toLowerCase();switch(r){case"button":Object.assign(n,ariaPatterns.button(t.children?.toString()));break;case"a":Object.assign(n,ariaPatterns.link(t.href));break;case"input":Object.assign(n,ariaPatterns.input(t.type,t.placeholder));break;case"img":t.alt||Object.assign(n,ariaPatterns.image());break;case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":const e=parseInt(r[1]);Object.assign(n,ariaPatterns.heading(e,t.children?.toString()));break;case"ul":case"ol":Object.assign(n,ariaPatterns.list());break;case"li":Object.assign(n,ariaPatterns.listitem());break;case"nav":Object.assign(n,ariaPatterns.navigation())}return n}class HeadingTracker{headings=[];warnings=[];addHeading(e){if(globalConfig.headingHierarchy){if(this.headings.length>0){const t=this.headings[this.headings.length-1];e>t+1&&this.warnings.push({type:"heading",severity:"warning",message:`Heading skips from h${t} to h${e}`,element:`h${e}`,suggestion:`Use h${t+1} instead of h${e} to maintain hierarchy`})}else 1!==e&&this.warnings.push({type:"heading",severity:"warning",message:`First heading is h${e}, should be h1`,element:`h${e}`,suggestion:"Start document with h1 for proper hierarchy"});this.headings.push(e)}}getWarnings(){return[...this.warnings]}reset(){this.headings=[],this.warnings=[]}}const headingTracker=new HeadingTracker;function validateHeadingHierarchy(e){if(e.match(/^h[1-6]$/i)){const t=parseInt(e[1]);headingTracker.addHeading(t)}}function getHeadingWarnings(){return headingTracker.getWarnings()}function resetHeadingTracker(){headingTracker.reset()}function getLuminance(e,t,n){const[r,s,a]=[e,t,n].map(e=>(e/=255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return.2126*r+.7152*s+.0722*a}function getContrastRatio(e,t){const n=e=>{if(e.startsWith("#")){const t=e.slice(1);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);return t?[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]:null},r=n(e),s=n(t);if(!r||!s)return 21;const a=getLuminance(...r),o=getLuminance(...s);return(Math.max(a,o)+.05)/(Math.min(a,o)+.05)}function validateColorContrast(e,t,n=!1){if(!globalConfig.colorContrast)return{passes:!0,ratio:21};const r=getContrastRatio(e,t),s=n?3:globalConfig.minContrastRatio,a=r>=s;return a?{passes:a,ratio:r}:{passes:a,ratio:r,warning:{type:"contrast",severity:"error",message:`Insufficient color contrast: ${r.toFixed(2)}:1 (minimum ${s}:1)`,suggestion:`Increase contrast between ${e} and ${t}`}}}class KeyboardNavigator{focusableSelectors=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(", ");getFocusableElements(e=document.body){return Array.from(e.querySelectorAll(this.focusableSelectors))}focusFirst(e){const t=this.getFocusableElements(e);t[0]?.focus()}focusLast(e){const t=this.getFocusableElements(e);t[t.length-1]?.focus()}focusNext(e){const t=this.getFocusableElements(e),n=t.indexOf(document.activeElement);if(-1===n)this.focusFirst(e);else{const e=(n+1)%t.length;t[e]?.focus()}}focusPrevious(e){const t=this.getFocusableElements(e),n=t.indexOf(document.activeElement);if(-1===n)this.focusLast(e);else{const e=0===n?t.length-1:n-1;t[e]?.focus()}}trapFocus(e){const t=t=>{if("Tab"!==t.key)return;const n=this.getFocusableElements(e),r=n[0],s=n[n.length-1];t.shiftKey?document.activeElement===r&&(t.preventDefault(),s?.focus()):document.activeElement===s&&(t.preventDefault(),r?.focus())};return e.addEventListener("keydown",t),this.focusFirst(e),()=>{e.removeEventListener("keydown",t)}}}const keyboardNavigator=new KeyboardNavigator;function createFocusManager(){const e=signal(null);return"undefined"!=typeof document&&document.addEventListener("focusin",t=>{e.set(t.target)}),{focusFirst:()=>keyboardNavigator.focusFirst(),focusLast:()=>keyboardNavigator.focusLast(),focusNext:()=>keyboardNavigator.focusNext(),focusPrevious:()=>keyboardNavigator.focusPrevious(),trapFocus:e=>keyboardNavigator.trapFocus(e),getCurrentFocus:()=>e}}function auditAccessibility(){const e=[];e.push(...getHeadingWarnings());const t=e.filter(e=>"error"===e.severity).length,n=e.filter(e=>"warning"===e.severity).length,r=Math.max(0,100-10*t-5*n),s=e.filter(e=>"info"===e.severity).length;return{warnings:e,score:r,passed:s,failed:t+n,timestamp:Date.now()}}function startA11yMonitoring(e=5e3){if(!globalConfig.devWarnings)return()=>{};let t;const n=()=>{const r=auditAccessibility();r.warnings.length>0&&(console.groupCollapsed(`%câ™¿ PhilJS A11y: ${r.warnings.length} issues found (Score: ${r.score}/100)`,"color: orange; font-weight: bold"),r.warnings.forEach(e=>{const t="error"===e.severity?"âŒ":"âš ï¸";console.log(`${t} [${e.type}] ${e.message}`),e.suggestion&&console.log(`   ðŸ’¡ ${e.suggestion}`)}),console.groupEnd()),t=setTimeout(n,e)};return n(),()=>{t&&clearTimeout(t)}}function addSkipLink(e="main-content"){return`\n<a\n  href="#${e}"\n  class="skip-link"\n  style="position: absolute; top: -40px; left: 0; background: #000; color: #fff; padding: 8px; z-index: 9999; transition: top 0.3s;"\n  onfocus="this.style.top='0'"\n  onblur="this.style.top='-40px'"\n>\n  Skip to main content\n</a>`}function announceToScreenReader(e,t="polite"){if("undefined"==typeof document)return;const n=document.createElement("div");n.setAttribute("role","status"),n.setAttribute("aria-live",t),n.setAttribute("aria-atomic","true"),n.className="sr-only",n.style.cssText="position: absolute; left: -10000px; width: 1px; height: 1px; overflow: hidden;",n.textContent=e,document.body.appendChild(n),setTimeout(()=>{document.body.removeChild(n)},1e3)}function createLoadingState(e="Loading..."){let t=!1;return{start:()=>{t||(t=!0,announceToScreenReader(e,"polite"))},stop:()=>{t&&(t=!1,announceToScreenReader("Finished loading","polite"))}}}class MemoryStorage{data=new Map;get(e){return this.data.get(e)||null}set(e,t){this.data.set(e,t)}remove(e){this.data.delete(e)}}class LocalStorageAdapter{get(e){if("undefined"==typeof localStorage||!localStorage.getItem)return null;try{return localStorage.getItem(e)}catch(e){return null}}set(e,t){if("undefined"!=typeof localStorage&&localStorage.setItem)try{localStorage.setItem(e,t)}catch(e){}}remove(e){if("undefined"!=typeof localStorage&&localStorage.removeItem)try{localStorage.removeItem(e)}catch(e){}}}class SessionStorageAdapter{get(e){return"undefined"==typeof sessionStorage?null:sessionStorage.getItem(e)}set(e,t){"undefined"!=typeof sessionStorage&&sessionStorage.setItem(e,t)}remove(e){"undefined"!=typeof sessionStorage&&sessionStorage.removeItem(e)}}class ABTestEngine{experiments=new Map;assignments=new Map;events=[];storage;config;constructor(e={}){switch(this.config={enabled:!0,storage:"localStorage",onAssignment:()=>{},onEvent:()=>{},forceVariants:{},...e},this.config.storage){case"localStorage":this.storage=new LocalStorageAdapter;break;case"sessionStorage":this.storage=new SessionStorageAdapter;break;default:this.storage=new MemoryStorage}this.loadAssignments()}register(e){this.experiments.set(e.id,e)}getVariant(e,t){if(!this.config.enabled)return null;const n=this.experiments.get(e);if(!n)return null;if(!this.isExperimentActive(n))return null;if(!this.matchesTargeting(n,t))return null;const r=this.config.forceVariants[e];if(r){const e=n.variants.find(e=>e.id===r);if(e)return e}const s=this.assignments.get(this.getAssignmentKey(e,t.id));if(s){const e=n.variants.find(e=>e.id===s.variantId);if(e)return e}const a=n.traffic??1;if(Math.random()>a)return null;const o=this.assignVariant(n,t);if(!o)return null;const i={experimentId:e,variantId:o.id,timestamp:Date.now()};return this.assignments.set(this.getAssignmentKey(e,t.id),i),this.saveAssignments(),this.config.onAssignment(i),o}track(e,t,n,r={}){const s={experimentId:e,variantId:t,eventName:n,value:r.value,userId:r.userId,timestamp:Date.now()};this.events.push(s),this.config.onEvent(s)}getResults(e){const t=this.experiments.get(e);if(!t)return null;const n=t.variants.map(t=>{const n=Array.from(this.assignments.values()).filter(n=>n.experimentId===e&&n.variantId===t.id).length,r=this.events.filter(n=>n.experimentId===e&&n.variantId===t.id),s=r.filter(e=>"conversion"===e.eventName).length,a=n>0?s/n:0,o=r.reduce((e,t)=>e+(t.value||0),0),i=s>0?o/s:void 0;return{variantId:t.id,impressions:n,conversions:s,conversionRate:a,averageValue:i,revenue:o}}),r=n.filter(e=>e.impressions>=100);let s,a;if(r.length>=2){const e=[...r].sort((e,t)=>t.conversionRate-e.conversionRate);s=e[0].variantId;const t=e[0].conversionRate-e[1].conversionRate;a=Math.min(.99,10*t)}const o=n.reduce((e,t)=>e+t.impressions,0);return{experimentId:e,variants:n,winner:s,confidence:a,sampleSize:o}}clear(){this.assignments.clear(),this.events=[],this.storage.remove("philjs_ab_assignments")}getActiveExperiments(){return Array.from(this.experiments.values()).filter(e=>this.isExperimentActive(e))}assignVariant(e,t){if(!e.variants||0===e.variants.length)return null;const n=e.variants.reduce((e,t)=>e+(t.weight??1),0),r=this.hashString(`${t.id}:${e.id}`)%1e4/1e4;let s=0;for(const t of e.variants){if(s+=(t.weight??1)/n,r<=s)return t}return e.variants[0]}matchesTargeting(e,t){if(!e.targeting)return!0;const{segments:n,custom:r,countries:s,devices:a}=e.targeting;return!(n&&n.length>0&&(!t.segments||!n.some(e=>t.segments.includes(e))))&&(!(r&&!r(t))&&(!(s&&s.length>0&&t.country&&!s.includes(t.country))&&!(a&&a.length>0&&t.device&&!a.includes(t.device))))}isExperimentActive(e){if(e.winner)return!1;const t=Date.now();return!(e.schedule?.start&&t<e.schedule.start.getTime())&&!(e.schedule?.end&&t>e.schedule.end.getTime())}getAssignmentKey(e,t){return`${e}:${t}`}hashString(e){let t=0;for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return Math.abs(t)}loadAssignments(){const e=this.storage.get("philjs_ab_assignments");if(e)try{const t=JSON.parse(e);this.assignments=new Map(Object.entries(t))}catch(e){}}saveAssignments(){const e=Object.fromEntries(this.assignments.entries());this.storage.set("philjs_ab_assignments",JSON.stringify(e))}}let globalEngine=null;function initABTesting(e={}){return globalEngine=new ABTestEngine(e),globalEngine}function getABTestEngine(){return globalEngine||(globalEngine=new ABTestEngine),globalEngine}function useExperiment(e,t){const n=signal(null),r=getABTestEngine();return n.set(r.getVariant(e,t)),n}function ABTest(e){const t=getABTestEngine().getVariant(e.experimentId,e.user);if(!t)return e.fallback?e.fallback():null;const n=e.variants[t.id];return n?n():null}function useFeatureFlag(e,t,n=!1){const r=signal(n),s=getABTestEngine();s.experiments.has(e)||s.register({id:e,name:e,variants:[{id:"off",name:"Off"},{id:"on",name:"On"}]});const a=s.getVariant(e,t);return r.set("on"===a?.id),r}function createMultivariateTest(e,t,n){return{id:e,name:t,variants:n.map(e=>({id:e,name:e}))}}function calculateSignificance(e,t,n,r){const s=e/t,a=n/r,o=(e+n)/(t+r),i=Math.sqrt(o*(1-o)*(1/t+1/r)),c=Math.abs(s-a)/i;return c>2.58?.99:c>1.96?.95:c>1.65?.9:c/2.58}export{ABTest,ABTestEngine,AITranslationService,CostTracker,Err,ErrorBoundary,FLIPAnimator,Fragment,I18nProvider,KeyboardNavigator,Ok,PerformanceBudgetManager,TranslationExtractor,UsageAnalytics,addSkipLink,andThen,announceToScreenReader,attachGestures,auditAccessibility,batch,calculateSignificance,combineProviders,configureA11y,costTracker,createAnimatedValue,createContext,createElement,createField,createFocusManager,createLoadingState,createLocaleMiddleware,createMultivariateTest,createMutation,createParallax,createQuery,createReducerContext,createRoot,createSignalContext,createThemeContext,defaultCacheRules,easings,effect,enhanceWithAria,errorRecovery,generateServiceWorker,getA11yConfig,getABTestEngine,getContrastRatio,getHeadingWarnings,getResumableState,hydrate,initABTesting,initResumability,invalidateQueries,isErr,isJSXElement,isOk,isResult,jsx,jsxDEV,jsxs,linkedSignal,map,mapErr,matchResult,memo,onCleanup,performanceBudgetPlugin,performanceBudgets,prefetchQuery,queryCache,registerHandler,registerServiceWorker,registerState,render,renderToStream,renderToString,resetHeadingTracker,resource,resumable,resume,serializeResumableState,setupGlobalErrorHandler,signal,skipWaitingAndClaim,startA11yMonitoring,unregisterServiceWorkers,untrack,unwrap,unwrapOr,usageAnalytics,useContext,useExperiment,useFeatureFlag,useForm,useI18n,useTranslation,validateColorContrast,validateHeadingHierarchy,v as validators};